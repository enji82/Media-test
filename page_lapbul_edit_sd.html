<div class="std-header">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
            <h1><i class="fas fa-edit" style="color:#f59e0b; margin-right:10px;"></i> Edit Laporan Bulan SD</h1>
            <p style="margin:5px 0 0 35px; color:#64748b; font-size:0.9em;">Perbarui data laporan bulanan sekolah dasar.</p>
        </div>
        <button onclick="App.loadPage(null, 'lapbul_kelola')" class="btn-action-sm" style="background:#fff; border:1px solid #cbd5e1; color:#475569; padding:8px 15px;">
            <i class="fas fa-arrow-left"></i> Kembali
        </button>
    </div>
</div>

<div class="std-content-wrapper">

    <!-- LOADING SPINNER -->
    <div id="loading-data" style="text-align:center; padding:50px;">
        <div class="spinner-border text-primary" role="status"></div>
        <p style="margin-top:15px; color:#64748b;">Mengambil data laporan...</p>
    </div>

    <!-- FORM CONTAINER (Hidden Awal) -->
    <div id="form-edit-container" style="display:none;">
        <div class="form-card">
            <form id="lapbulEditFormSd" style="display: flex; flex-direction: column; height: 100%;" autocomplete="off">
                <!-- Hidden Fields -->
                <input type="hidden" name="rowIndex">
                <input type="hidden" name="source" value="SD">

                <div class="tabs-header">
                    <button type="button" class="tab-link active" data-tab="edit_dataSekolah">1. Data Sekolah</button>
                    <button type="button" class="tab-link" data-tab="edit_dataMurid">2. Data Murid</button>
                    <button type="button" class="tab-link" data-tab="edit_dataPtk">3. Data PTK</button>
                    <button type="button" class="tab-link" data-tab="edit_dataUnggah">4. Dokumen</button>
                </div>

                <div class="tab-content-wrapper">

                    <!-- TAB 1: DATA SEKOLAH -->
                    <div id="edit_dataSekolah" class="tab-content-form active">
                        <div class="form-grid-2">
                            <div class="form-group">
                                <label>Bulan Laporan</label>
                                <!-- Readonly / Disabled -->
                                <select name="Bulan" class="form-control" style="background:#f1f5f9; pointer-events:none;" tabindex="-1">
                                    <option value="">-- Pilih Bulan --</option>
                                    <option value="Januari">Januari</option><option value="Februari">Februari</option><option value="Maret">Maret</option><option value="April">April</option><option value="Mei">Mei</option><option value="Juni">Juni</option><option value="Juli">Juli</option><option value="Agustus">Agustus</option><option value="September">September</option><option value="Oktober">Oktober</option><option value="November">November</option><option value="Desember">Desember</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Tahun</label>
                                <!-- Opsi tahun akan diisi JS -->
                                <select name="Tahun" id="edit_input_tahun" class="form-control" style="background:#f1f5f9; pointer-events:none;" tabindex="-1">
                                    <option value="">Memuat...</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-building"></i> Identitas Sekolah</h3>
                            <div class="form-grid-2">
                                <div class="form-group">
                                    <label>Status Sekolah</label>
                                    <select id="edit_statusSekolah" name="Status" class="form-control" style="background:#f1f5f9; pointer-events:none;" tabindex="-1">
                                        <option value="" selected disabled>-- Pilih Status --</option>
                                        <option value="Negeri">Negeri</option>
                                        <option value="Swasta">Swasta</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Nama Sekolah</label>
                                    <input type="text" id="edit_namaSekolah" name="Nama Sekolah" class="form-control" readonly style="background:#f1f5f9;">
                                </div>
                            </div>
                            <div class="form-grid-2">
                                <div class="form-group"><label>NPSN</label><input type="text" name="NPSN" class="form-control" pattern="\d*" title="Hanya angka"></div>
                                <div class="form-group"><label>Jumlah Rombel (Total)</label><input type="number" name="Rombel" class="form-control" min="1" max="50"></div>
                            </div>
                        </div>
                        <div class="tab-form-footer">
                            <div></div>
                            <!-- Data target disesuaikan dengan ID Tab Edit -->
                            <button type="button" class="btn-primary next-tab-btn" data-target="edit_dataMurid">Berikutnya</button>
                        </div>
                    </div>

                    <!-- TAB 2: DATA MURID -->
                    <div id="edit_dataMurid" class="tab-content-form">
                        <!-- ID Container Unik untuk Edit -->
                        <div id="edit-subTabContainer" class="sub-tabs-container"></div>
                        <div id="edit-kelasContentArea"></div>

                        <div class="tab-form-footer">
                            <button type="button" class="btn-secondary prev-tab-btn" data-target="edit_dataSekolah">Sebelumnya</button>
                            <button type="button" class="btn-primary next-tab-btn" data-target="edit_dataPtk">Berikutnya</button>
                        </div>
                    </div>

                    <!-- TAB 3: DATA PTK -->
                    <div id="edit_dataPtk" class="tab-content-form">
                        
                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-user-tie"></i> Kepala Sekolah</h3>
                            <div class="form-grid-4">
                                <div class="form-group"><label>PNS</label><input type="number" name="KS PNS" class="form-control val-ks" min="0" max="1"></div>
                                <div class="form-group"><label>PPPK</label><input type="number" name="KS PPPK" class="form-control val-ks" min="0" max="1"></div>
                                <div class="form-group"><label>Non ASN</label><input type="number" name="KS NON ASN" class="form-control val-ks" min="0" max="1"></div>
                            </div>
                            <div class="alert-box" id="edit-ptk-alert-box" style="display:none; margin-top:10px;"></div>
                        </div>

                        <div class="form-section">
                            <h3 class="form-section-title"><i class="fas fa-chalkboard-teacher"></i> Data Guru</h3>
                            <div class="table-responsive-wrapper" style="border:none;"> 
                                <table class="matrix-input-table">
                                    <thead>
                                    <tr>
                                        <th style="width: 25%;">Jenis Guru</th>
                                        <th>PNS</th><th>PPPK</th><th>PPPK PW</th><th>GTY</th><th>GTT</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>Guru Kelas</td><td><input type="number" name="GK PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GK PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GK PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GK GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GK GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru PAI</td><td><input type="number" name="GPAI PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPAI PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPAI PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPAI GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPAI GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru PJOK</td><td><input type="number" name="GPJOK PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPJOK PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPJOK PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPJOK GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPJOK GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru PA Kristen</td><td><input type="number" name="GPA KRIS PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KRIS PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KRIS PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KRIS GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KRIS GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru PA Katolik</td><td><input type="number" name="GPA KAT PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KAT PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KAT PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KAT GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GPA KAT GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru Bhs. Inggris</td><td><input type="number" name="GBING PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GBING PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GBING PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GBING GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GBING GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                        <tr><td>Guru Mapel Lain</td><td><input type="number" name="GMAP PNS" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GMAP PPPK" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GMAP PPPK PW" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GMAP GTY" class="form-control-mini val-guru" min="0"></td><td><input type="number" name="GMAP GTT" class="form-control-mini val-guru" min="0"></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3 class="form-section-title">Tenaga Kependidikan</h3>
                            <div class="table-responsive-wrapper">
                                <table class="matrix-input-table">
                                    <thead>
                                    <tr>
                                        <th style="width: 25%;">Jenis Tendik</th>
                                        <th>PNS</th><th>PPPK</th><th>PPPK PW</th><th>PTY</th><th>PTT</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>Pengelola Umum Operasional</td><td><input type="number" name="PUO PNS" class="form-control-mini" min="0"></td><td><input type="number" name="PUO PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="PUO PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="PUO PTY" class="form-control-mini" min="0"></td><td><input type="number" name="PUO PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Operator Layanan</td><td><input type="number" name="OLO PNS" class="form-control-mini" min="0"></td><td><input type="number" name="OLO PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="OLO PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="OLO PTY" class="form-control-mini" min="0"></td><td><input type="number" name="OLO PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Pengelola Layanan</td><td><input type="number" name="PLO PNS" class="form-control-mini" min="0"></td><td><input type="number" name="PLO PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="PLO PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="PLO PTY" class="form-control-mini" min="0"></td><td><input type="number" name="PLO PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Penata Layanan</td><td><input type="number" name="PTLO PNS" class="form-control-mini" min="0"></td><td><input type="number" name="PTLO PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="PTLO PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="PTLO PTY" class="form-control-mini" min="0"></td><td><input type="number" name="PTLO PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Adm. Perkantoran</td><td><input type="number" name="ADM KAN PNS" class="form-control-mini" min="0"></td><td><input type="number" name="ADM KAN PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="ADM KAN PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="ADM KAN PTY" class="form-control-mini" min="0"></td><td><input type="number" name="ADM KAN PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Penjaga Sekolah</td><td><input type="number" name="PJG PNS" class="form-control-mini" min="0"></td><td><input type="number" name="PJG PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="PJG PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="PJG PTY" class="form-control-mini" min="0"></td><td><input type="number" name="PJG PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Tenaga Administrasi</td><td><input type="number" name="TAS PNS" class="form-control-mini" min="0"></td><td><input type="number" name="TAS PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="TAS PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="TAS PTY" class="form-control-mini" min="0"></td><td><input type="number" name="TAS PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Pustakawan</td><td><input type="number" name="PUST PNS" class="form-control-mini" min="0"></td><td><input type="number" name="PUST PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="PUST PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="PUST PTY" class="form-control-mini" min="0"></td><td><input type="number" name="PUST PTT" class="form-control-mini" min="0"></td></tr>
                                        <tr><td>Tendik Lainnya</td><td><input type="number" name="TDKLAIN PNS" class="form-control-mini" min="0"></td><td><input type="number" name="TDKLAIN PPPK" class="form-control-mini" min="0"></td><td><input type="number" name="TDKLAIN PPPK PW" class="form-control-mini" min="0"></td><td><input type="number" name="TDKLAIN PTY" class="form-control-mini" min="0"></td><td><input type="number" name="TDKLAIN PTT" class="form-control-mini" min="0"></td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="tab-form-footer">
                            <button type="button" class="btn-secondary prev-tab-btn" data-target="edit_dataMurid">Sebelumnya</button>
                            <button type="button" class="btn-primary next-tab-btn" data-target="edit_dataUnggah">Berikutnya</button>
                        </div>
                    </div>

                    <!-- TAB 4: UNGGAH DOKUMEN -->
                    <div id="edit_dataUnggah" class="tab-content-form">
                        <div class="form-section" style="text-align:center;">
                            <h3 class="form-section-title" style="justify-content:center;"><i class="fas fa-file-upload"></i> Unggah Dokumen</h3>
                            
                            <!-- Area Preview File Lama -->
                            <div style="background:#f0f9ff; border:1px solid #bae6fd; padding:15px; border-radius:8px; display:flex; align-items:center; gap:15px; margin-bottom:20px; max-width:600px; margin:0 auto 20px auto;">
                                <div id="existingFileLink" style="flex:1; display:flex; align-items:center; gap:15px;">
                                    <!-- Diisi JS -->
                                </div>
                            </div>

                            <p style="color:#64748b; margin-bottom:20px;">Upload scan laporan bulan asli yang sudah ditandatangani dalam format PDF jika ingin mengubah file.</p>
                            <div class="file-upload-area" onclick="document.getElementById('fileLapbulSdEdit').click()" style="max-width:500px; margin:0 auto;">
                                <i class="fas fa-cloud-upload-alt" style="font-size:3em; color:var(--primary); margin-bottom:10px;"></i>
                                <h4 style="margin:5px 0; color:#334155;">Klik untuk memilih file</h4>
                                <p style="color:#94a3b8; font-size:0.9em; margin:0;">Maksimal 300 KB.</p>
                                <input type="file" id="fileLapbulSdEdit" name="fileData" accept=".pdf" style="display:none;" onchange="document.getElementById('fileNameSdEdit').textContent = this.files[0] ? this.files[0].name : ''">
                            </div>
                            <div id="fileNameSdEdit" style="margin-top:15px; font-weight:bold; color:var(--primary);"></div>
                        </div>
                        <div class="tab-form-footer">
                            <button type="button" class="btn-secondary prev-tab-btn" data-target="edit_dataPtk">Sebelumnya</button>
                            <button type="submit" class="btn-primary" id="finalSubmitBtnSd"><i class="fas fa-save"></i> SIMPAN PERUBAHAN</button>
                        </div>
                    </div>

                </div>
            </form>
        </div>
    </div>
</div>