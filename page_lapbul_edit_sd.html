<div class="std-header">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <div>
            <h1><i class="fas fa-edit" style="color:#f59e0b; margin-right:10px;"></i> Edit Laporan Bulanan (SD)</h1>
            <p style="margin:5px 0 0 35px; color:#64748b; font-size:0.9em;">Perbarui data laporan bulanan sekolah dasar.</p>
        </div>
        <button onclick="App.loadPage(null, 'lapbul_kelola')" class="btn-action-sm" style="background:#fff; border:1px solid #cbd5e1; color:#475569; padding:8px 15px;">
            <i class="fas fa-arrow-left"></i> Kembali
        </button>
    </div>
</div>

<div class="std-content-wrapper">

    <!-- LOADING SPINNER AWAL -->
    <div id="loading-data" style="text-align:center; padding:50px;">
        <div class="spinner-border text-primary" role="status"></div>
        <p style="margin-top:15px; color:#64748b;">Mengambil data laporan...</p>
    </div>

    <!-- CONTAINER FORM (Hidden Awal) -->
    <div id="form-edit-container" style="display:none;">
        <div class="form-container">
            <form id="lapbulEditFormSd">
                <!-- Hidden Fields Penting -->
                <input type="hidden" name="rowIndex">
                <input type="hidden" name="source" value="SD">

                <!-- TAB NAVIGASI -->
                <div class="form-tabs" id="tab-nav">
                    <button type="button" class="tab-link active" data-tab="dataSekolah">1. Lembaga</button>
                    <button type="button" class="tab-link" data-tab="dataMurid">2. Murid</button>
                    <button type="button" class="tab-link" data-tab="dataPtk">3. PTK</button>
                    <button type="button" class="tab-link" data-tab="dataUnggah">4. Dokumen</button>
                </div>

                <!-- TAB 1: DATA SEKOLAH -->
                <div id="dataSekolah" class="tab-content-form active">
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                        <div class="form-group">
                            <label>Nama Sekolah</label>
                            <input type="text" name="Nama Sekolah" class="std-input" readonly style="background:#f1f5f9;">
                        </div>
                        <div class="form-group">
                            <label>NPSN</label>
                            <input type="text" name="NPSN" class="std-input" readonly style="background:#f1f5f9;">
                        </div>
                        <div class="form-group">
                            <label>Kecamatan</label>
                            <input type="text" name="Kecamatan" class="std-input">
                        </div>
                        <div class="form-group">
                            <label>Desa/Kelurahan</label>
                            <input type="text" name="Kelurahan" class="std-input">
                        </div>
                        <div class="form-group">
                            <label>Status Sekolah</label>
                            <input type="text" name="Status" class="std-input" readonly style="background:#f1f5f9;">
                        </div>
                        <div class="form-group">
                            <label>Email Sekolah</label>
                            <input type="email" name="Email" class="std-input">
                        </div>
                    </div>

                    <div style="margin-top:20px; text-align:right;">
                        <button type="button" class="submit-btn next-tab-btn" data-target="dataMurid">Selanjutnya <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <!-- TAB 2: DATA MURID (DINAMIS GENERATED BY JS) -->
                <div id="dataMurid" class="tab-content-form">
                    
                    <!-- Sub-Tab Kelas 1-6 -->
                    <div id="edit-subTabContainer" class="sub-tabs-container">
                        <!-- Diisi oleh JS (App.setupSdEditLogic) -->
                    </div>

                    <!-- Area Input Dinamis -->
                    <div id="edit-kelasContentArea" style="min-height:300px;">
                        <!-- Diisi oleh JS -->
                    </div>
                    
                    <div style="margin-top:20px; display:flex; justify-content:space-between;">
                        <button type="button" class="btn-secondary prev-tab-btn" data-target="dataSekolah"><i class="fas fa-arrow-left"></i> Sebelumnya</button>
                        <button type="button" class="submit-btn next-tab-btn" data-target="dataPtk">Selanjutnya <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <!-- TAB 3: DATA PTK -->
                <div id="dataPtk" class="tab-content-form">
                    <h5 style="border-bottom:1px solid #e2e8f0; padding-bottom:10px; margin-bottom:15px; color:#334155;">Rekapitulasi Guru & Tendik</h5>
                    
                    <div class="alert-box" id="ptk-alert-box" style="display:none;"></div>

                    <!-- Input Grid Sederhana untuk PTK -->
                    <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap:15px;">
                        
                        <!-- Kepala Sekolah -->
                        <div class="input-box-card">
                            <span class="box-title">Kepala Sekolah</span>
                            <div class="lp-wrapper">
                                <div class="lp-field"><label>PNS</label><input type="number" name="KS PNS" class="form-control-mini val-ks"></div>
                                <div class="lp-field"><label>PPPK</label><input type="number" name="KS PPPK" class="form-control-mini val-ks"></div>
                                <div class="lp-field"><label>Non ASN</label><input type="number" name="KS NON ASN" class="form-control-mini val-ks"></div>
                            </div>
                        </div>

                        <!-- Guru Kelas -->
                        <div class="input-box-card">
                            <span class="box-title">Guru Kelas</span>
                            <div class="lp-wrapper">
                                <div class="lp-field"><label>PNS</label><input type="number" name="Guru Kelas PNS" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>PPPK</label><input type="number" name="Guru Kelas PPPK" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>Non ASN</label><input type="number" name="Guru Kelas NON ASN" class="form-control-mini val-guru"></div>
                            </div>
                        </div>

                        <!-- Guru PAI -->
                        <div class="input-box-card">
                            <span class="box-title">Guru PAI</span>
                            <div class="lp-wrapper">
                                <div class="lp-field"><label>PNS</label><input type="number" name="Guru PAI PNS" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>PPPK</label><input type="number" name="Guru PAI PPPK" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>Non ASN</label><input type="number" name="Guru PAI NON ASN" class="form-control-mini val-guru"></div>
                            </div>
                        </div>
                        
                        <!-- Guru PJOK -->
                        <div class="input-box-card">
                            <span class="box-title">Guru PJOK</span>
                            <div class="lp-wrapper">
                                <div class="lp-field"><label>PNS</label><input type="number" name="Guru PJOK PNS" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>PPPK</label><input type="number" name="Guru PJOK PPPK" class="form-control-mini val-guru"></div>
                                <div class="lp-field"><label>Non ASN</label><input type="number" name="Guru PJOK NON ASN" class="form-control-mini val-guru"></div>
                            </div>
                        </div>

                        <!-- Penjaga & Pustakawan -->
                         <div class="input-box-card">
                            <span class="box-title">Tendik Lainnya</span>
                            <div class="lp-wrapper">
                                <div class="lp-field"><label>Penjaga</label><input type="number" name="Penjaga Sekolah" class="form-control-mini"></div>
                                <div class="lp-field"><label>Pustaka</label><input type="number" name="Tenaga Pustakawan" class="form-control-mini"></div>
                                <div class="lp-field"><label>Admin</label><input type="number" name="Tenaga Administrasi" class="form-control-mini"></div>
                            </div>
                        </div>

                    </div>

                    <div style="margin-top:20px; display:flex; justify-content:space-between;">
                        <button type="button" class="btn-secondary prev-tab-btn" data-target="dataMurid"><i class="fas fa-arrow-left"></i> Sebelumnya</button>
                        <button type="button" class="submit-btn next-tab-btn" data-target="dataUnggah">Selanjutnya <i class="fas fa-arrow-right"></i></button>
                    </div>
                </div>

                <!-- TAB 4: UNGGAH DOKUMEN -->
                <div id="dataUnggah" class="tab-content-form">
                    
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin-bottom:20px;">
                        <div class="form-group">
                            <label>Tahun Laporan</label>
                            <select name="Tahun" class="std-input">
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Bulan Laporan</label>
                            <select name="Bulan" class="std-input">
                                <option value="Januari">Januari</option>
                                <option value="Februari">Februari</option>
                                <!-- dst -->
                            </select>
                        </div>
                    </div>

                    <!-- File Preview -->
                    <div style="background:#f8fafc; border:1px solid #e2e8f0; padding:15px; border-radius:8px; display:flex; align-items:center; gap:15px; margin-bottom:20px;">
                        <div id="existingFileLink" style="flex:1; display:flex; align-items:center; gap:15px;">
                            <!-- Diisi JS -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Update File (Opsional)</label>
                        <input type="file" id="fileLapbulSdEdit" name="fileLapbul" class="std-input" accept="application/pdf">
                        <small style="color:#64748b;">Maksimal 1MB, Format PDF.</small>
                    </div>

                    <div style="margin-top:30px; display:flex; justify-content:space-between; border-top:1px solid #e2e8f0; padding-top:20px;">
                        <button type="button" class="btn-secondary prev-tab-btn" data-target="dataPtk"><i class="fas fa-arrow-left"></i> Sebelumnya</button>
                        <button type="submit" id="edit-lapbul-sd-submit" class="submit-btn"><i class="fas fa-save"></i> SIMPAN PERUBAHAN</button>
                    </div>
                </div>

            </form>
        </div>
    </div>
</div>